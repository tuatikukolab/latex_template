\documentclass[report,10.5pt,oneside,openany,a4paper]{jsbook}
\pagenumbering{arabic}

\usepackage[top=30truemm, bottom=30truemm, left=25truemm, right=25truemm]{geometry}

\usepackage{amsmath,amssymb}
\usepackage{mathtools}
\usepackage{bm}
\usepackage[dvipdfmx]{graphicx}
\usepackage{subcaption}
\usepackage{verbatim}
\usepackage{wrapfig}
\usepackage{ascmac}
\usepackage{makeidx}
\usepackage{url}
\usepackage{listings,jvlisting}
\usepackage{here}
\usepackage{times}
\usepackage{fancyhdr}

\usepackage{titlesec}
\usepackage{picture}
\usepackage[dvipdfmx]{color}
\usepackage[cc]{titlepic}

\usepackage[dvipdfmx]{hyperref}
\usepackage{pxjahyper}

\usepackage{afterpage}

% colors
\definecolor{teal}{RGB}{0,128,128}
\definecolor{powderblue}{RGB}{176,224,230}
\definecolor{darkslateblue}{RGB}{72,61,139}
\definecolor{darkslategray}{RGB}{47,79,79}
\definecolor{lightcyan}{RGB}{224,255,255}

% chapter          
\titleformat{\chapter}[block]
{}{}{0pt}{
  \fontsize{40pt}{40pt}\selectfont\filright
}[
  \hrule
]

% section
\titleformat{\section}[block]
{}{}{0pt}
{
  \colorbox{teal}{\begin{picture}(0,20)\end{picture}}
  \hspace{0pt}
  \normalfont \Huge\bfseries \thesection
  \hspace{-4pt}
}
[
\begin{picture}(100,0)
  \put(3,30){\color{teal}\line(1,0){450}}
\end{picture}
\\
\vspace{-50pt}
]

% subsection
\titleformat{\subsection}[block]
{}{}{0pt}
{
  \colorbox{darkslateblue}{\begin{picture}(0,10)\end{picture}}
  \hspace{0pt}
  \normalfont \Large\bfseries \thesubsection
  \hspace{-4pt}
}
[
\begin{picture}(100,0)
  \put(3,18){\color{darkslateblue}\line(1,0){450}}
\end{picture}
\\
\vspace{-30pt}
]

% subsubsection
\titleformat{\subsubsection}[block]
{}{}{0pt}
{
  \colorbox{darkslategray}{\begin{picture}(0,10)\end{picture}}
  \hspace{0pt}
  \normalfont \Large\bfseries \thesubsection
  \hspace{-4pt}
}
[
\begin{picture}(100,0)
  \put(3,18){\color{darkslategray}\line(1,0){450}}
\end{picture}
\\
\vspace{-30pt}
]

% list for programs
\lstset{
  basicstyle={\ttfamily},
  identifierstyle={\small},
  commentstyle={\smallitshape},
  keywordstyle={\small\bfseries},
  ndkeywordstyle={\small},
  stringstyle={\small\ttfamily},
  frame={tb},
  breaklines=true,
  columns=[l]{fullflexible},
  numbers=left,
  xrightmargin=0zw,
  xleftmargin=3zw,
  numberstyle={\scriptsize},
  stepnumber=1,
  numbersep=1zw,
  lineskip=-0.5ex
}
\renewcommand{\lstlistingname}{プログラム}

% header
\setlength{\headheight}{50pt} % ヘッダーの高さを設定

\makeatletter
\renewcommand{\chapter}{
  \clearpage
  \global\@topnum\z@
  \secdef\@chapter\@schapter}
\makeatother

\pagestyle{fancyplain}
\fancyhead{}
\renewcommand{\chaptermark}[1]{\markboth{第\ \thechapter\ 章\,\, #1}{}}
\fancyhead[r]{{\footnotesize \rightmark}}
\renewcommand{\headrulewidth}{0pt} % 既存のヘッダー罫線を消す
\fancyhead[r]{ % ヘッダーの内容
  \footnotesize \rightmark \\
  \rule[0pt]{16cm}{0.5pt} % 罫線の長さと太さを設定。長さを10cmに変更
}

% footer
\fancyfoot{} % フッターをクリア
\fancyfoot[C]{{\footnotesize \thepage}} % ページ番号を中央に表示

\makeindex

%\setlength{\baselineskip}{18pt}
\setlength{\textwidth}{\fullwidth}
\setlength{\textheight}{40\baselineskip}
\addtolength{\textheight}{\topskip}
\setlength{\voffset}{-0.55in}

\begin{document}

%タイトル開始

\begin{titlepage}
  \begin{center}
  \vspace*{50truept}
  {\Huge ここに題目を書く}\\ % タイトル
  \vspace{10truept}
  {\Large You write your title here in English}\\ % サブタイトル
  \vspace{20truept}
  {\Huge  自分野名前\ }\\ % 名前
  \vspace{10truept}
  {\Large Namae JIBUNNO}\\ %ローマ字名
  \vspace{20truept}
  {\normalsize (20xx年度入学, 00000000)}\\ % 学籍番号
  \vspace{20truept}
  {
  \begin{figure}[h]
  \begin{center}
    \includegraphics[width=.3\textwidth]{figure/facephoto.jpg} % 自分の顔写真(要らない場合はコメントアウトする)
  \end{center}
  \end{figure}
  }
  \vspace{20truept}
  {\huge 指導教員: 清水郁子 教授 \ }\\ % 指導教員名
  \vspace{10truept}
  {\normalsize 東京農工大学 工学部 知能情報システム工学科}\\
  \vspace{10truept}
  {\normalsize 20xx 年度卒業論文}\\
  \vspace{10truept}
  {\normalsize (20xx年 x月 x日 提出)}\\ % 提出日
  \end{center}
\end{titlepage}

\begin{titlepage}
  \include{abstract}
\end{titlepage}

%タイトル終わり
\frontmatter

\tableofcontents % 目次のリスト
\listoffigures % 図のリスト
\listoftables % 表のリスト

\mainmatter

\include{chap1}
\include{chap2}
\include{chap3}
\include{chap4}
\include{chap5}
\include{acknowledgments} % 謝辞

\appendix
\include{appendix1} % 付録(つけない場合は\includeの部分ごとコメントアウトする)

\bibliographystyle{jplain} 
\bibliography{references} % 参考文献

\newpage
\printindex
\end{document}
